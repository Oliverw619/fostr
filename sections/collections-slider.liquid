{%- capture flickity_options -%}
{
  "prevNextButtons": false,
  "pageDots": false,
  "contain": true,
  "cellAlign": "left",
  "groupCells": true,
  "arrowShape": {"x0": 20, "x1": 60, "y1": 40, "x2": 60, "y2": 35, "x3": 25}
}
{%- endcapture -%}

<div class="featured-collection-slider page-width">
{% if section.settings.title != blank %}
<div class="section-header text-center">
  <h2>{{ section.settings.title | escape }}</h2>
</div>
{% endif %}
 
{%- assign collection = collections[section.settings.collection] -%}
{%- assign product_limit = section.settings.product_count -%}
 
    <div class="products-carousel js-flickity" data-flickity='{{ flickity_options }}'>
      {% for product in collection.products limit: product_limit %}
        <div class="carousel-cell">
            {% for tag in product.tags %}
            {% if tag == "label-new" %}
            <div class="label-new">NEW!</div>
            {% endif%}
            {% endfor %}
            <a href="{{ product.url | within: collection }}" style="text-decoration: none;">
                <img class="img-explore" src="{{ product.featured_image | img_url: 'master'}}">
                <h4 class="featured-title">{{ product.title }}</h4>
                <p class="featured-description">{{ product.description | truncate: 140 }}</p>
                <div class="price
                    {%- if price_class %} {{ price_class }}{% endif -%}
                    {%- if available == false %} price--sold-out {% endif -%}
                    {%- if compare_at_price > price %} price--on-sale {% endif -%}
                    {%- if product.price_varies == false and product.compare_at_price_varies %} price--no-compare{% endif -%}
                    {%- if show_badges %} price--show-badge{% endif -%}">
                    <div class="price__container">
                        {%- comment -%}
                        Explanation of description list:
                            - div.price__regular: Displayed when there are no variants on sale
                            - div.price__sale: Displayed when a variant is a sale
                        {%- endcomment -%}
                        <div class="price__regular">
                        <span class="visually-hidden visually-hidden--inline">{{ 'products.product.price.regular_price' | t }}</span>
                        <span class="price-item price-item--regular">
                            {{ money_price }}
                        </span>
                        </div>
                        <div class="price__sale">
                        {%- unless product.price_varies == false and product.compare_at_price_varies %}
                            <span class="visually-hidden visually-hidden--inline">{{ 'products.product.price.regular_price' | t }}</span>
                            <span>
                            <s class="price-item price-item--regular">
                                {% if settings.currency_code_enabled %}
                                {{ compare_at_price | money_with_currency }}
                                {% else %}
                                {{ compare_at_price | money }}
                                {% endif %}
                            </s>
                            </span>
                        {%- endunless -%}
                        <span class="visually-hidden visually-hidden--inline">{{ 'products.product.price.sale_price' | t }}</span>
                        <span class="price-item price-item--sale price-item--last">
                            {{ money_price }}
                        </span>
                        </div>
                        <small class="unit-price caption{% if product.selected_or_first_available_variant.unit_price_measurement == nil %} hidden{% endif %}">
                        <span class="visually-hidden">{{ 'products.product.price.unit_price' | t }}</span>
                        <span class="price-item price-item--last">
                            <span>{{- product.selected_or_first_available_variant.unit_price | money -}}</span>
                            <span aria-hidden="true">/</span>
                            <span class="visually-hidden">&nbsp;{{ 'accessibility.unit_price_separator' | t }}&nbsp;</span>
                            <span>
                            {%- if product.selected_or_first_available_variant.unit_price_measurement.reference_value != 1 -%}
                                {{- product.selected_or_first_available_variant.unit_price_measurement.reference_value -}}
                            {%- endif -%}
                            {{ product.selected_or_first_available_variant.unit_price_measurement.reference_unit }}
                            </span>
                        </span>
                        </small>
                    </div>
                    {%- if show_badges -%}
                        <span class="badge price__badge-sale color-{{ settings.sale_badge_color_scheme }}">
                        {{ 'products.product.on_sale' | t }}
                        </span>

                        <span class="badge price__badge-sold-out color-{{ settings.sold_out_badge_color_scheme }}">
                        {{ 'products.product.sold_out' | t }}
                        </span>
                    {%- endif -%}
                    </div>
                            </a>
                        </div>  
                        {% endfor %}
                        </div>
                    </div>

<style>
    .featured-collection-slider {
        padding-left: 55px;
        padding-right: 55px;
        max-width: 1200px;
        margin: 0 auto;
    }
    .featured-collection-slider .carousel-cell {
        width:25%;
        padding: 0 15px;
        display: block;
    }
    .flickity-button:disabled {
        pointer-events: all!important;
    }
    @media screen and (max-width: 920px){
        .featured-collection-slider {
            padding-left: 15px;
            padding-right: 15px;srezrt
        }
        .featured-collection-slider .carousel-cell{
            width:50%;
        }
    }
    @media screen and (max-width: 767px){
        .featured-collection-slider .carousel-cell{
            width:100%;
        }
    }
    .featured-title {
        text-decoration: none;
        font-size: 22px;
        color: #111111
    }
    .featured-description {
        text-decoration: none;
        color: #4D4D4D;
        font-size: 1rem;
    }
    .featured-price {
        color: #4D4D4D;
    }
    .label-new {
        border: 2px solid var( â€” color-base-background-1);
        margin-top: 1em;
        padding: 0.3em 0.5em;
        z-index: 2;
        position: absolute;
        font-size: 0.875em;
        color: #ffffff;
        background-color: #bc0000;
    }
</style>

{% schema %}
{
  "name": "Collection Slider",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Heading",
      "default": "Featured Collection"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "product_count",
      "min": 4,
      "max": 12,
      "label": "Number of products to display",
      "default": 4
    }
  ],
  "presets": [
    {
      "category": "Collection",
      "name": "Collection Slider",
      "settings": {}
    }
  ]
}
{% endschema %}